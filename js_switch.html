<!DOCTYPE html>
<html class="no-js">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title></title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="">
    <script src="https://code.jquery.com/jquery-1.8.3.js"
        integrity="sha256-dW19+sSjW7V1Q/Z3KD1saC6NcE5TUIhLJzJbrdKzxKc=" crossorigin="anonymous"></script>
    <style>
        *{padding:0;margin:0;}
        ul,li{list-style-type:none;}
        .ui_tab{padding-top:100px}
        .tab_content {position: relative;border: solid 1px red;width: 300px;height: 200px;}
        .tab_content li { display:none;width: 300px;height: 200px;}
        .tab_content li iframe{width:100%;height:100%;}
        .tabs:after{display:block;content:'';clear: both;}
        .tabs li {color: black;width:100px;height:50px;float:left;cursor: pointer;background-color:bisque;border:solid 1px brown;position:relative;text-align: center}
        .tabs li.selected {color:black;font-size:200%;background-color:darkgoldenrod}
        .tabs li.disabled {color: gray;cursor:auto;background-color:darkgray;}
        .tabs li#t1.disabled:after{content:'5월18일에만나요';background-color:cadetblue;width:100px;height:50px;position:absolute;top:-50px;display:block;}
        .tabs li#t2.disabled:after{content:'5월25일에만나요';background-color:cadetblue;width:100px;height:50px;position:absolute;top:-50px;display:block;}
    </style>
</head>

<body>
    <div class="ui_tab">
        <ul class="tabs">
            <li id="t0"> 5/16</li>
            <li id="t1">5/18</li>
            <li id="t2">5/25</li>
        </ul>
        <ul class="tab_content">
            <li class="con_1" >
                <div id='tv0'>

                        <iframe src="http:you/dd/dd/fdfdfd";
                </div>
            </li>
            <li class="con_2">
                <div id='tv1'>
                        <iframe src="http:you/dd/dd/";
                </div>
            </li>
            <li class="con_3">
                <div id='tv2'>
                        <iframe src="http:you/dd/dd/";
                </div>
            </li>
        </div>
</div>
    <script>
        //서버에서 변경1 : switch_0 / switch_1 / switch_2 
        var switcher = "switch_0";
        //서버에서 변경2
        var youArr1 = <?= ?>;
        var youArr2 = <?= ?>;
        var youArr3 = <?= ?>;
        var tvAdressArr = ["bmMUPl1HgMU", "IjwkUlFZUMQ", "bmMUPl1HgMU"];
        //서버에서 받아온 변수1로 열린 탭 갯수 저장. 갯수만큼 동영상 API 생성 
        var numberOfOpenTabs;
        //youtubeAPI호출(레이지로드)
        var tag = document.createElement('script');
        tag.src = "https://www.youtube.com/iframe_api";
        var firstScriptTag = document.getElementsByTagName('script')[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
        var players = [];
        var playerReadyFlags = [false, false, false];
        var currentIndex;

        //글로벌영역
        function onYouTubeIframeAPIReady() {
            var elements = ['tv0', 'tv1', 'tv2'];
            //열린 탭 만큼 유투브 API 객체 생성
            for (var i = 0; i < numberOfOpenTabs; i++) {
                players.push(createPlayer(elements[i], i));
            }
        }

        //유투브 API 호출
        function createPlayer(id, playerIndex) {
            return new YT.Player(id, {
                videoId: tvAdressArr[playerIndex],
                hl:'ko_KR',
                wmode:'transparent',
                title:'df',
                host: 'https://www.youtube.com',
                events: {
                    'onReady': function (e) { onPlayerReady(playerIndex, e); }
                }
            });
        }

        function onPlayerReady(idx, event) {
                console.log('onPlayerReady: ' + idx);
                playerReadyFlags[idx] = true;
                if (idx === currentIndex) playCurrentPauseOthers(idx);
            }

        $(function () {
           

            //현재탭 제외하고 동영상 일시정지 
            function playCurrentPauseOthers(idx) {
                console.log('playCurrentPauseOthers');
                for (var i = 0; i < playerReadyFlags.length; i++) {
                    if (!playerReadyFlags[i]) continue; //for IE
                    if (i === idx) {
                        players[i].playVideo();
                        console.log('play: ' + i.toString());
                    } else {
                        players[i].pauseVideo();
                        console.log('pause: ' + i.toString());
                    }
                }
            }


            //혹시 존재할 중요 클래스 제거 
            //$('.tabs li').removeClass('selected');

            //서버 변수 switch_0 일 경우 탭 셋팅(5월 16일) 
            if (switcher == "switch_0") {
                $('.tabs li').eq(0).addClass('selected');
                $('.tabs li').eq(1).addClass('disabled');
                $('.tabs li').eq(2).addClass('disabled');
                numberOfOpenTabs = 1;
            }

            //서버 변수 switch_1 일 경우 탭 셋팅(5월 18일 마회텔 1 공개)
            else if (switcher == "switch_1") {
                $('.tabs li').eq(1).addClass('selected');
                $('.tabs li').eq(2).addClass('disabled');
                numberOfOpenTabs = 2;

            }

            //서버 변수 switch_2일 경우 탭 셋팅(5월 25일 마회텔 2 공개)
            else if (switcher == "switch_2") {
                $('.tabs li').eq(2).addClass('selected');
                numberOfOpenTabs = 3;
            }

            //현재 탭 인덱스
            var currentTabIndex = $('.tabs li.selected').index();

            //스위치에 따른 아이프레임 src 넣기 
            //오픈된 탭 수만큼 배열을 순회
            //for (var j = 0; j < numberOfOpenTabs; j++) {
             //   $('.tab_content div').eq(j).find('iframe').attr('src', "https://www.youtube.com/embed/" + tvAdressArr[j] + "?rel=0&autoplay=1&hl=ko_KR&wmode=transparent&enablejsapi=1");
            //}

            //초기 렌더링 시에 현재탭 동영상 보여주기
            
            $('.tab_content li').eq(currentTabIndex).show();
            
            //렌더링 후 탭 클릭시 작동
            $('.tabs li').click(function () {
                //탭 클릭시 작동 제외 탭 
                if ($(this).hasClass('disabled') || $(this).hasClass('selected')) {
                    return false;
                }

                //탭 기능 작동
                var indexAnk = $(this).index();
                currentIndex = indexAnk;
                var arrTv = [0, 1, 2];
                var currentTv = arrTv[indexAnk];
                var slideCurrentTv = arrTv.splice(currentTv, 1);
                $('.tabs li').removeClass('selected');
                $(this).addClass('selected');
                $('.tab_content li').hide().eq(indexAnk).show();
                
                //탭 동영상제어     
                playCurrentPauseOthers(currentIndex);

            });

        });


    </script>
</body>

</html>